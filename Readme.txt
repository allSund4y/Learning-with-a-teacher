1. Описание проекта:
Интернет-магазин «В один клик» продаёт разные товары: для детей, для дома, мелкую бытовую технику, косметику и даже продукты. Отчёт магазина за прошлый период показал, что активность покупателей начала снижаться. Привлекать новых клиентов уже не так эффективно: о магазине и так знает большая часть целевой аудитории. Возможный выход — удерживать активность постоянных клиентов. Сделать это можно с помощью персонализированных предложений.

«В один клик» — современная компания, поэтому её руководство не хочет принимать решения просто так — только на основе анализа данных и бизнес-моделирования. У компании есть небольшой отдел цифровых технологий, и вам предстоит побыть в роли стажёра в этом отделе. 

Итак, вашему отделу поручили разработать решение, которое позволит персонализировать предложения постоянным клиентам, чтобы увеличить их покупательскую активность.

2. Как решать задачу:
a. Нужно промаркировать уровень финансовой активности постоянных покупателей. В компании принято выделять два уровня активности: «снизилась», если клиент стал покупать меньше товаров, и «прежний уровень».
b. Нужно собрать данные по клиентам по следующим группам:
- Признаки, которые описывают коммуникацию сотрудников компании с клиентом.
- Признаки, которые описывают продуктовое поведение покупателя. Например, какие товары покупает и как часто.
- Признаки, которые описывают покупательское поведение клиента. Например, сколько тратил в магазине.
- Признаки, которые описывают поведение покупателя на сайте. Например, как много страниц просматривает и сколько времени проводит на сайте.
3. Основные этапы работы:
	1. Загрузка данных и изучение общей информации о датафреймах
	2. Предобработка данных
 	- изучение и обработка пропущенных значений
 	- проверка соответствия типов данных
 	- поиск и обработка убликатов
	3. Исследовательский анализ данных
	4. Объединение датафреймов и корреляционный анализ признаков итоговой таблицы
	5. Корреляционный анализ
	6. Обучение моделей испульзуя пайплайны
	7. Анализ важности признаков с помощью SHAP
	8. Сегментация покупателей
	9. Общий вывод

Для поиска лучшей модели:

- был проведён корреляционный анализ всех признаков с целевым
- был подготовлен объединённый датафрейм для моделирования
- данные были разделены на выборки с учётом стратифакации, так как был обнаружен дисбаланс классов
- для выбора лучшей комбинации модели и гиперпараметров был создан пайплайн, в который вошли модели:
 - KNeighborsClassifier():
   - n_neighbors от 2 до 4
 - DecisionTreeClassifier():
   - max_depth от 2 до 4
   - max_features от 2 до 4 включительно (у нас много признаков)
 - LogisticRegression():
   - C от 1 до 4
 - SVC():
   - C от 1 до 9

эффективность выбранной модели оценивали метрикой ROC-AUC на тренировочной и тестовой выборках. Данная метрика лучше всего подходит для задачи бинарной классификации с несбалансированным целевым признаком.

В результате была выбрана лучшая модель:

Лучшая модель - SVC(kernel='linear') с `C` = 6 и скелером `MinMaxScaler()`

Метрика лучшей модели на тренировочной выборке: 0.8926089395180303

Метрика ROC-AUC на тестовой выборке: 0.918

Выбранный сегмент для анализа:

- покупатели с высокой прибыльностью (>5)
- и высокой вероятностью снижения покупательской активности (>0.2)

Предложения для выбранного сегмента покупателей:

- Предложить пользователям, склонным к акционным покупкам, промокоды на скидки на товары тех категорий, которые они предпочитают, исходя из данных за прошлые месяцы

- Попробовать затянуть покупателей сегмента глубже в сайт, сделать так, чтобы они просматривали больше страниц. Больше страниц больше контактов с сайтом, а значит и больше вероятность совершения покупки

- Пользователям со стандартным обслуживанием сделать выгодное предложение на переход на премиум-обслуживание

- Внутри сегмента предложить покупателям категорий Косметика и аксессуары и Товары для детей скидки на данные категории